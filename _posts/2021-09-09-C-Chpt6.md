---
layout: default
title:  "Chapter 6. Spectial Functions"
description: "Numerical Recipes in C"
date:   2021-09-09 15:07:00 +0100
categories: notes
---

This set of notes is based on Chapter 6 in Numerical Recipes in C. 


Codes for implementing algorithms mentioned in this chapter are available at [my Github repository](https://github.com/jadecci/numerical_recipes_c). Each script runs the respective algorithm with example data.

## 1. Gamma, Beta, Factorials, Binomial

The gamma function is defined in relation to the factorial function for integer $z$s (see part 1 in [my notes on distributions](https://jadecci.github.io/notes/Distribution.html) for a simple proof)

$$
\Gamma(z) = \int^{\infty}_0 t^{z-1}e^{-t} \mathop{dt} = (z-1)!
$$

In order to estimate the gamma function outputs, the Lanczos approximation is used, which accounts for all $\mathbb{Re} (z)>0$

$$
\Gamma(z+1) = (z+\gamma+\frac{1}{2})^{z+\frac{1}{2}} e^{-(z+\gamma+\frac{1}{2})} \sqrt{2\pi} (c_0 + \frac{c_1}{z+1} + \frac{c_2}{z+2} + ... +  + \frac{c_3}{z+3} + \epsilon)
$$

As the value of $\Gamma(z)$ can often become overflowingly large, but only required in intermediate steps, it is better to solve for $\ln \Gamma(z)$ instead in practice. Relatedly, the factorial functions can also be estimated as $exp(\ln \Gamma(z+1))$. 

Again, if we can compute $\ln (z!)$, we can continue to estimate the binomial coefficients, which is defined as

$$
{n \choose k} = \frac{n!}{k!(n-k)!} \quad 0 \le k \le n
$$

Finally, computing $\ln \Gamma(z)$ also lets us compute the beta function, which is defined as

$$
B(z, x) = \int^1_0 t^{z-1} (1-t)^{x-1} \mathop{dt} 
$$

and can be computed by (see Appendix A for the proof)

$$
B(z, x) = \frac{\Gamma(z) \Gamma(x)}{\Gamma(z+x)}
$$

## 2. Incomplete Gamma, Error, Chi-Square, Cumlative-Poisson

The incomplete gamma function bound in the range $[0, 1]$ with different slopes depending on the value of $x$. It is defined by

$$
P(z, x) = \frac{\gamma(z, x)}{\Gamma(z)} = \frac{1}{\Gamma(z)} \int^{x}_0 t^{z-1}e^{-t} \mathop{dt} \quad (a>0) \\
$$

where $\Gamma(z)$ is the gamma function from the previous section. We can approximate $\gamma(z, x)$ by

$$
\gamma(z, x) = \int^x_0 t^{z-1}e^{-t} \mathop{dt} = e^{-x} x^{z} \sum^{\infty}_{t=0} \frac{\Gamma(z)}{\Gamma(z+1+t)} x^t 
$$

Its complement is also sometimes called an incomplete gamma function

$$
Q(z, x) = 1 - P(z, x) = \frac{\Gamma(z, x)}{\Gamma(z)} = \frac{1}{\Gamma(z)} \int^{\infty}_x t^{z-1}e^{-t} \mathop{dt} \quad (a>0)
$$


## 3. Incomplete Beta, Student's F, Cumulative Binomial

## Appendix

### A. Relationship between beta and gamma functions

We start with the numerator of the right-hand side

$$
\begin{aligned}
\Gamma(z) \Gamma(x) &= \int^{\infty}_0 t^{z-1}e^{-t} \mathop{dt} \int^{\infty}_0 s^{x-1}e^{-s} \mathop{ds} \\
&= \int^{\infty}_0 \int^{\infty}_0 t^{z-1}s^{x-1}e^{-t-s} \mathop{ds} \mathop{dt} \\
\end{aligned}
$$

Applying a change of variable, where $t=uv$ and $s=u(1-v)$, we obtain the new differentials 
$$
\mathop{ds} \mathop{dt} = |\det (D\phi)(u,v)|\mathop{du} \mathop{dv} 
$$

where $(D\phi)(u,v)$ is the Jacobian matrix of partial derivatives of $(s,t) = \phi (u, v)$ at point $(u,v)$. Hence

$$
\begin{aligned}
\mathop{ds} \mathop{dt} &= |\det \begin{bmatrix} \frac{\partial s}{\partial u} & \frac{\partial s}{\partial v} \\ \frac{\partial t}{\partial u} & \frac{\partial t}{\partial v} \end{bmatrix}  | \mathop{du} \mathop{dv} \\
&=|\det \begin{bmatrix} 1-v & -u \\ v & u \end{bmatrix}  | \mathop{du} \mathop{dv} \\
&= |u(1-v)-(-u)v| \mathop{du} \mathop{dv} \\
&= u \mathop{du} \mathop{dv}
\end{aligned}
$$

Now we have

$$
\begin{aligned}
\Gamma(z) \Gamma(x) &= \int^{\infty}_0 \int^1_0 (uv)^{z-1}[u(1-v)]^{x-1}e^{-uv-u(1-v)} u \mathop{dv} \mathop{du}\\
&= \int^{\infty}_0  u^{z+x-1} e^{-u} \mathop{du} \int^1_0 v^{z-1} (1-v)^{x-1} \mathop{dv} \\
&= \Gamma(z+x)B(z,x)
\end{aligned}
$$
