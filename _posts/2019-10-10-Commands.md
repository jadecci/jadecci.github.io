---
layout: default
title:  "Useful Commands"
date:   2019-10-10 15:07:00 +0100
categories: notes
---

This set of notes include commands for Unix, Bash, Matlab, Python, etc. that I found useful or easily forgotten.

# Linux

## Linux in general

- Give read & execute rights to all users for a folder and its subfolders

```
chmod -R 755 $folder_name
```

- Find file in current folder and subfolders

```
find . -name "$file_name"
```

- Print lines (i.e. rows) `x` to `y` in a text file

```
head -y $file_name | tail -n $((y-x+1))
```

- Extract columns `x` and `y` from a csv file

```
cat $file_name.csv | cut -d ',' -f x,y
```

- Rename part of file name(s)

```
rename "s/${old_part}/${new_part}/" $file_name
```

- List size of folders/files in ascending order

```
du -sh * | sorth -h
```


## MacOS Terminal (uname = Darwin)

- After any major/semi-major update, the command line tool should be updated with 

```
xcode-select --install
```

- Insert the plus/minus sign Â±: `shift` + `alt (options)` + `=`

- Combine pdf on command line

```
(In .bashrc or .zshrc) alias combine_pdf="/System/Library/Automator/Combine\ PDF\ Pages.action/Contents/Resources/join.py"
combine_pdf -o $output.pdf $input1.pdf $input2.pdf ... $inputn.pdf
```

## Git related

- Create a new branch based on the `develop` branch

```
git checkout -b $branch_name develop
```

- Delete last commit, keeping the work done

```
git reset --soft HEAD~1
```

- Delete a commit, discarding work done (i.e. reverting the changes)

```
git reset --hard $commit_number
```

- Delete  a branch from both local and remote repositories

```
git branch -d $branch_name
git push origin --delete $branch_name
```

- Update a forked repository with feature branch `$branch_name`(assuming no conflict)

```
git checkout develop
git pull upstream develop
git push origin -f develop
git checkout $branch_name
git rebase develop
```

- Changed a cloned copy to a forked copy & make current branch track a forked branch (e.g. `master` branch)

```
git remote rename origin upstream
git remote add origin $fork_address
git branch -u origin/master
```

- Check changes in a file before committing

```
(unstaged) git diff $file_name
(staged) git diff --cached $file_named
```

## Bash

- Extract part of a string (e.g. getting 0843 from Sub0843_Ses1)

```
string=Sub0843_Ses1
string_cut_end=${string%_Ses1}
string_cut_front=${string_cut_end#Sub}
```

- Remove all leading spaces from `zsh` console output
```
string="    Sub0843_Ses1"
string_cut=${string##*[[:blank:]]}
```

- Floating point operations (e.g. `x+y/365`)

```
echo x y 365 | awk '{printf "%4.3f", $1+$2/$3}'
```

- Suppress 1) warnings and errors 2) all outputs from a command

```
1) $command 2> /dev/null
2) $command 1> /dev/null 2>&1
```

- The above might not work inside a script, in which case the `exec` command can be used before the commands generating warnings/outputs.

```
1) exec 2> /dev/null
2) exec 1> /dev/null 2>&1
```


## SSH related

- Save host and user name in `~/.ssh/config`

```
Host $new_host_name
	Hostname $host_address
	User $user_name
```

- File transfer between local machine and SSH server (For transfering a folder, add `-r` to recursively copy all files and subdirectories)

```
(local to server) scp $file_path user@host:$destination
(server to local) scp user@host:$file_path $destination
```

# Python

- Since Python 3.4 (I think), it's preferable to use `pip` with

```
python3 -m pip list
python3 -m pip install --upgrade pip --user
python3 -m pip install numpy
```

- Print elapsed time in hour-minute-second format

```
import time
time.strftime("%H:%M:%S", time.gmtime(elapsed_time))
```

- Create function handle (i.e. equivalent to `myfunc = @(x) func(10, x)` in Matlab)

```
myfunc = lambda x: func(10, x)
```

- Call function with dynamic name

```
(from another module) output = getattr(module_name, 'func_name')(parameters)
(from the same module) output = globals()['func_name'](parameters)
```

- Reload a module (to reflect changes made to the module)

```
from importlib import reload
reload(module_name)
```

- Write `stdout` to a log file at real time (from command line)

```
python -u $file_name.py > $log_name.txt
```

# Matlab

- Write `long` values to a csv file (e.g. with a precision of `6`)

```
dlmwrite('file_name.csv', variable_name, 'precision', 6);
```

# Vi(m)

- turn off search (#) highlighting

```
:noh
```

# Others

- Build a site with Jekyll locally

```
bundle exec jekyll serve
(in the browser) http://localhost:4000
```
